(function(a,c){"function"===typeof define&&define.amd?define([],c):"object"===typeof module&&module.exports?module.exports=c(a):a.IframeActionCommunicator=c(a)})(this,function(a){var c=a||global.window;a=function(b){this.registeredActions={};this.$iFrame=null;this.parentInstance=!1;if(b)if(this.$iFrame=c.document.getElementById(b))this.parentInstance=!0;else return console.error(this.constructor.name+": Iframe with '"+b+"' id wasn't founded");this.initListener()};a.prototype.initListener=function(){var b=
this,a=window.addEventListener?"addEventListener":"attachEvent";c[a]("attachEvent"===a?"onmessage":"message",function(a){console.log("event",a);if(a.source!==c){try{var d=JSON.parse(a.data)}catch(f){d=!1}a=d;d=a.constructor===Object?a.action:a;if(!d)return console.error(b.constructor.name+": Action mustn't be empty. Please, pass action like a string or like an object in key 'action'");if(b.registeredActions[d]){if(a.constructor===Object)return b.registeredActions[a.action](a.data);if("string"===typeof a)return b.registeredActions[d]()}else console.error(b.constructor.name+
": Any handler doesn't subscribe on '"+d+"' action")}},!1)};a.prototype.send=function(a){if(!a||"string"!==typeof a&&a.constructor!==Object)return console.error(this.constructor.name+": post argument doesn't must empty and type me be 'string' or 'object'");try{var b=JSON.stringify(a)}catch(e){b=!1}a=b;this.parentInstance?this.$iFrame.contentWindow.postMessage(a,"*"):c.parent.postMessage(a,"*")};a.prototype.on=function(a,c){this.registeredActions[a]=c};return a});